<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
    <title>
      Hueue Console
    </title>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <style>
      table, td, th {
          border: 1px solid #ddd;
          text-align: left;
      }
      table {
          border-collapse: collapse;
          width: 50%;
      }
      th, td {
          padding: 15px;
      }
      th {background-color: #FF0F50;}
      tr:hover{background-color:#f5f5f5}
    </style>
  </head>
  <h1>Hueue dashboard :o</h1>
  <br><br>

  Jobs:
  <br>
  <div id="jobs">
  </div>
  <br><br>

  <div id="oauthLogin">
  </div>
  <br><br>

  <a href="">Dequeue all jobs :o</a>
  <br><br>

  <a href="">Go to the login page</a>
</html>

<script type="text/javascript">
    $.getJSON('get_jobs', function (jobs) {
        var content = "<table>"
        content += '<tr>'
          + '<th><bold>Repo</bold></th>'
          + '<th><bold>Base Branch</bold></th>'
          + '<th><bold>Merging Branch</bold></th>'
          + '<th><bold>Actions</bold></th>'
        '</tr>';
        for (i = 0; i < jobs.length; i++) {
            content += '<tr>'
              + '<td>' + jobs[i].repoID + '</td>'
              + '<td>' + jobs[i].srcBranch + '</td>'
              + '<td>' + jobs[i].dstBranch + '</td>'
              + '<td>' + '<a href="/modifyJob?action=kill&repoID=jobs[i].repoID">kill</a> <a href="/modifyJob?action=suspend&repoID=jobs[i].repoID">suspend</a> <a href="/modifyJob?action=resume&repoID=jobs[i].repoID">resume</a></td>'
              + '</tr>';
        }
        content += "</table>"
        $('#jobs').append(content);
    });

    getOauthURL = function() {
      var url = "http://34.208.168.142:3000";
      var githubClientID = "416fdf5ed5fb66f16bd3";
      var oauthURL = "https://github.com/login/oauth/authorize"
                      + "?client_id="    + githubClientID
                      + "&redirect_uri=" + url + "/oauthRedirect"
                      + "&scope="        + "repo"
                      + "&state="        + "142857"
                      + "&allow_signup=" + "true";
      return oauthURL;
    }

    $('#oauthLogin').append("<a href=" + getOauthURL() + ">Give Hueue access</a>");
</script>